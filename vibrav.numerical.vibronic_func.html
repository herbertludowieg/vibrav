<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>vibrav.numerical.vibronic_func module &#8212; vibrav  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="vibrav.numerical.vroa_func module" href="vibrav.numerical.vroa_func.html" />
    <link rel="prev" title="vibrav.numerical.redmass module" href="vibrav.numerical.redmass.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          vibrav</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="examples/adf.html">ADF parser API</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/gen-displaced.html">Generating the displaced structures from a Gaussian frequencies calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/molcas.html">Molcas parser API</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/numerical-diffs.html">Using derivative module</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/vibronic.html">Running vibronic calculations from a Molcas RASSI set of calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/vroa-h2o2.html">VROA intensities of hydrogen peroxide</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/vroa-methyloxirane.html">VROA intensities of methyloxirane</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/zpvc.html">Tutorial for using the ZPVC module in VIBRAV</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="vibrav.html">vibrav package</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">vibrav.numerical.vibronic_func module</a><ul>
<li><a class="reference internal" href="#vibrav.numerical.vibronic_func.compute_d_dq"><code class="docutils literal notranslate"><span class="pre">compute_d_dq()</span></code></a></li>
<li><a class="reference internal" href="#vibrav.numerical.vibronic_func.compute_d_dq_sf"><code class="docutils literal notranslate"><span class="pre">compute_d_dq_sf()</span></code></a></li>
<li><a class="reference internal" href="#vibrav.numerical.vibronic_func.sf_to_so"><code class="docutils literal notranslate"><span class="pre">sf_to_so()</span></code></a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="vibrav.numerical.redmass.html" title="Previous Chapter: vibrav.numerical.redmass module"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; vibrav.numeri...</span>
    </a>
  </li>
  <li>
    <a href="vibrav.numerical.vroa_func.html" title="Next Chapter: vibrav.numerical.vroa_func module"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">vibrav.numeri... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/vibrav.numerical.vibronic_func.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="module-vibrav.numerical.vibronic_func">
<span id="vibrav-numerical-vibronic-func-module"></span><h1>vibrav.numerical.vibronic_func module<a class="headerlink" href="#module-vibrav.numerical.vibronic_func" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="vibrav.numerical.vibronic_func.compute_d_dq">
<span class="sig-prename descclassname"><span class="pre">vibrav.numerical.vibronic_func.</span></span><span class="sig-name descname"><span class="pre">compute_d_dq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nstates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_so</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dprop_dq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vibrav/numerical/vibronic_func.html#compute_d_dq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vibrav.numerical.vibronic_func.compute_d_dq" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform complex transformation with the eigen vectors to convert the spin-free derivatives to
spin-orbit derivatives of the property of interest. The equation is as follows,</p>
<div class="math notranslate nohighlight">
\[\left&lt;\psi_1^{SO}|\mu^e|\psi_2^{SO}\right&gt; = \sum_{k,m}U_{k1}^{0*}U_{m2}^{0}
                            \left&lt;\psi_k|\mu_{1,2}^{e,SF}\left(Q\right)|\psi_m\right&gt;\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nstates</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, input) – Number of spin-orbit states.</p></li>
<li><p><strong>eigvectors</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, input) – Array containing the eigen vectors read from the eigvectors.txt
file produced by Molcas.</p></li>
<li><p><strong>prop_so</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, input) – Extended spin-free derivatives with the proper size. Output from
<cite>vibrav.numerical.vibronic_func.sf_to_so</cite> function.</p></li>
<li><p><strong>dprop_so</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, output) – Spin-orbit derivatives of the property of interest.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vibrav.numerical.vibronic_func.compute_d_dq_sf">
<span class="sig-prename descclassname"><span class="pre">vibrav.numerical.vibronic_func.</span></span><span class="sig-name descname"><span class="pre">compute_d_dq_sf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nstates_sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dham_dq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies_sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dprop_dq_sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incl_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vibrav/numerical/vibronic_func.html#compute_d_dq_sf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vibrav.numerical.vibronic_func.compute_d_dq_sf" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the spin-free derivative of the chosen property given by the following equation,</p>
<div class="math notranslate nohighlight">
\[A = \sum_{k\neq 1}\left&lt;\psi_k^0|\mu^e|\psi_2^0\right&gt;
    \frac{\partial\left&lt;\psi_1^0|H|\psi_k^0\right&gt;  / \partial Q_p}{E_1^0 - E_k^0}\]</div>
<div class="math notranslate nohighlight">
\[B = \sum_{k\neq 2}\left&lt;\psi_1^0|\mu^e|\psi_k^0\right&gt;
    \frac{\partial\left&lt;\psi_1^0|H|\psi_k^0\right&gt; / \partial Q_p}{E_1^0 - E_k^0}\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial\mu_{1,2}^{e}\left(Q\right)}{\partial Q_p} = A + B\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nstates_sf</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, input) – Number of spin free states.</p></li>
<li><p><strong>dham_dq</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, input) – Derivative of the Hamiltonian with respect to the normal
coordinate.</p></li>
<li><p><strong>eq_sf</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, input) – Spin-free values of the property parsed from the equilibrium
geometry.</p></li>
<li><p><strong>energies_sf</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, input) – Spin-free energies parsed from the equilibrium geometry.</p></li>
<li><p><strong>dprop_dq_sf</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, output) – Spin-free derivative of the property of interest.</p></li>
<li><p><strong>tol</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>, optional, input) – Tolerance value for the energy differences.
Defaults to <code class="code docutils literal notranslate"><span class="pre">1e-5</span></code>.</p></li>
<li><p><strong>incl_states</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, input) – Select the states that you want to use. Typically
would be used by the user to select how many states
to include in the SOS. Defaults to <code class="code docutils literal notranslate"><span class="pre">None</span></code>
(all available states are included).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vibrav.numerical.vibronic_func.sf_to_so">
<span class="sig-prename descclassname"><span class="pre">vibrav.numerical.vibronic_func.</span></span><span class="sig-name descname"><span class="pre">sf_to_so</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nstates_sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nstates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dprop_dq_sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dprop_dq_so</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vibrav/numerical/vibronic_func.html#sf_to_so"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vibrav.numerical.vibronic_func.sf_to_so" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend the spin-free derivative from the number of spin-free states into the number of
spin-orbit states. It does not change any of the values, rather it will only duplicate each of
the spin-free values by its respective multiplicity. In principle it can be thought of as
follows:</p>
<p>Given a spin-free derivative matrix made up of 2 doublets and 3 singlets</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">d_11</span><span class="p">,</span> <span class="n">d_12</span><span class="p">,</span> <span class="n">d_13</span><span class="p">,</span> <span class="n">d_14</span><span class="p">,</span> <span class="n">d_15</span><span class="p">],</span>
 <span class="p">[</span><span class="n">d_21</span><span class="p">,</span> <span class="n">d_22</span><span class="p">,</span> <span class="n">d_23</span><span class="p">,</span> <span class="n">d_24</span><span class="p">,</span> <span class="n">d_25</span><span class="p">],</span>
 <span class="p">[</span><span class="n">d_31</span><span class="p">,</span> <span class="n">d_32</span><span class="p">,</span> <span class="n">d_33</span><span class="p">,</span> <span class="n">d_34</span><span class="p">,</span> <span class="n">d_35</span><span class="p">],</span>
 <span class="p">[</span><span class="n">d_41</span><span class="p">,</span> <span class="n">d_42</span><span class="p">,</span> <span class="n">d_43</span><span class="p">,</span> <span class="n">d_44</span><span class="p">,</span> <span class="n">d_45</span><span class="p">],</span>
 <span class="p">[</span><span class="n">d_51</span><span class="p">,</span> <span class="n">d_52</span><span class="p">,</span> <span class="n">d_53</span><span class="p">,</span> <span class="n">d_54</span><span class="p">,</span> <span class="n">d_55</span><span class="p">]]</span>
</pre></div>
</div>
<p>Here, d_mn are the individual matrix elements. Now we extend each by its respective multiplicity,
assuming that states of different multiplicity do not interact.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">d_11</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="n">d_12</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">],</span>
 <span class="p">[</span>   <span class="mi">0</span><span class="p">,</span> <span class="n">d_11</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="n">d_12</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">],</span>
 <span class="p">[</span><span class="n">d_21</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="n">d_22</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">],</span>
 <span class="p">[</span>   <span class="mi">0</span><span class="p">,</span> <span class="n">d_21</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="n">d_22</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">],</span>
 <span class="p">[</span>   <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="n">d_33</span><span class="p">,</span> <span class="n">d_34</span><span class="p">,</span> <span class="n">d_35</span><span class="p">],</span>
 <span class="p">[</span>   <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="n">d_43</span><span class="p">,</span> <span class="n">d_44</span><span class="p">,</span> <span class="n">d_45</span><span class="p">],</span>
 <span class="p">[</span>   <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span> <span class="n">d_53</span><span class="p">,</span> <span class="n">d_54</span><span class="p">,</span> <span class="n">d_55</span><span class="p">]]</span>
</pre></div>
</div>
<p>Now we have a matrix made of the spin-free elements with the dimension of the spin-orbit states.
Note, this is not the spin-orbit matrix. This is only to prepare the matrix for the complex
transformation with the eigenvectors gotten from Molcas in the eigectors.txt file. That is taken
care of by the following equation,</p>
<div class="math notranslate nohighlight">
\[\left&lt;\psi_1^{SO}|\mu^e|\psi_2^{SO}\right&gt; = \sum_{k,m}U_{k1}^{0*}U_{m2}^{0}
                            \left&lt;\psi_k|\mu_{1,2}^{e,SF}\left(Q\right)|\psi_m\right&gt;\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nstates_sf</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, input) – Number of spin-free states.</p></li>
<li><p><strong>nstates</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code>, input) – Number of spin-orbit states.</p></li>
<li><p><strong>multiplicity</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, input) – 1D array detailing which spin-free states have which
multiplicity.</p></li>
<li><p><strong>dprop_dq_sf</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, input) – Array of the spin-free derivative elements.</p></li>
<li><p><strong>dprop_dq_so</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>, output) – Array of the spin-free derivatives extended to the size of
spin-orbit states.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2023, Herbert D Ludowieg. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.0.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>